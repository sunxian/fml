<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="cn.com.fml.mvc.dao.intf.TbCustomerDao">
<!-- 累计带看次数 -->
	<select id="queryTimesByMonth" resultType="Integer" parameterType="java.lang.Integer">
		select count(id) from tb_customer_report 
WHERE `STATUS`='2' and DATE_FORMAT(UPDATE_TIME,'%Y%m')=DATE_FORMAT(SYSDATE(),'%Y%m') ;
	</select>
	
	<select id="queryTimesByYear" resultType="Integer" parameterType="java.lang.Integer">
		select count(id) from tb_customer_report 
WHERE `STATUS`='2' and DATE_FORMAT(UPDATE_TIME,'%Y')=DATE_FORMAT(SYSDATE(),'%Y') ;
	</select>
	
	<select id="queryTimesByWeek" resultType="Integer" parameterType="java.lang.Integer">
		select count(id) from tb_customer_report 
WHERE `STATUS`='2' and DATE_FORMAT(UPDATE_TIME,'%Y%u')=DATE_FORMAT(SYSDATE(),'%Y%u') ;
	</select>
	<!--  查找成交量报表数据-->
	<select id="queryReports" resultType="Map" parameterType="java.util.Map">
select DATE_FORMAT(UPDATE_TIME,'%Y%m') date,count(id) as times from tb_customer_report 
WHERE `STATUS`='3' GROUP BY DATE_FORMAT(UPDATE_TIME,'%Y%m') ;
	</select>	
</mapper>